<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowTech | Login & Cadastro</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <div class="container">
            <a class="titulo" href="#"><div class="tituloNav">FLOWTECH</div></a>
            <div class="navbar">
                <ul>
                    <li><a href="../index/index.html">Home</a></li>
                    |
                    <li>Ajuda</li>
                </ul>
            </div>
        </div>
    </nav>

    <div id="telaCadastro" class="telaCadastro">
            <div class="container">
                <h1>Cadastro</h1>


                <div class="inputs_cad"> 
                <div class="divcaixatexto"> 
                    
                    <div class="caixatexto">
                        <label for="nome"></label>
                        <input placeholder="Nome:" type="text" id="input_nome" name="nome" class="bloco1" required>

                        <label for="cpf"></label>
                        <input placeholder="CPF: (apenas números)" type="text" id="input_cpf" name="cpf" class="bloco1" required>

                        <label for="email"></label>
                        <input placeholder="E-mail:" type="email" id="input_email_cad" name="email" class="bloco1" required>

                        <label for="senha"></label>
                        <input placeholder="Senha:" type="password" id="input_senha_cad" name="senha" class="bloco1" required>
                    </div>
                
                </div>

                <div class="divcaixatexto2">
                   
                    <div class="caixatexto">

                        <label for="nascimento"></label>
                        <input placeholder="Nascimento:" type="text" id="input_nascimento" name="nascimento" class="bloco2" required>

                        <label for="telefone"></label>
                        <input placeholder="Tel:" type="tel" id="input_telefone" name="telefone" class="bloco2" required>

                        <label for="niveldeacesso"></label>
                        <select name="niveldeacesso" id="niveldeacesso" class="bloco2"  required>
                            <option value="" selected hidden>Nível de Acesso:</option>
                            <option value="Proprietário">Proprietário</option>
                            <option value="Gerente">Gerente</option>
                            <option value="Funcionário">Funcionário</option>
                        </select>
                
                        <label for="codigodeacesso"></label>
                        <input placeholder="Código de Acesso:" type="password" id="codigodeacesso" name="codigodeacesso" class="bloco2" required>
                    </div>
                </div> 
            </div>

            <div class="buttons"> 
                <button class="enviar" onclick="cadastrar()">Cadastrar</button>
                <button class="codigo" onclick="codigo()">Solicitar Cód. Acesso</button>
            </div> 

            <div class="links">
                <a onclick="trocarLogin()">Já tenho Conta</a>
            </div>
                         
            </div>  
            
    </center>
    </div>



    <main id="telaLogin" class="telaLogin" style="display: none;">
        <div class="container">
            <div class="form">
                <h2 class="titulo">LOGIN</h2>
                
                <input type="text" id="input_login" placeholder="Login">
                <input type="password" id="input_senha" placeholder="Senha">

                <button onclick="autenticar()">Entrar</button>

                <div class="links" id="esqueci_senha">
                    <a onclick="trocarSenha()">Esqueci minha Senha</a>
                    <span> | </span>
                    <a onclick="trocarCadastro()">Criar Conta</a>
                </div>

                <div class="links" id="termos">
                    <a href="#">Política de Privacidade</a>
                    <span> | </span>
                    <a href="#">Termos de Serviço</a>
                </div>
            </div>
        </div>
    </main>

    <main id="telaSenha" class="telaSenha" style="display: none;">
        <div class="container">
            <div class="form">
                <h2 class="titulo">Esqueci Minha Senha</h2>
                
                <input type="text" id="input_Remail" placeholder="Email">
                <input type="password" id="input_Rcdg" placeholder="Código">

                <input type="password" id="input_NovaSenha" class="NovaSenha" placeholder="Inserir Nova Senha" style="display: none;">

                <div class="bts">
                <button onclick="gerar()" class="cdg" id="bt_gerar">Gerar código</button>
                <button onclick="redefinir()" id="bt_redefinir_senha">Redefinir Senha</button>
                <button onclick="salvar()" id="bt_salvar_senha" style="display: none;">Salvar Senha</button>
                </div>

                


                <div class="links" id="esqueci_senha">
                    <a onclick="trocarLogin()">Voltar</a>
                    <span> | </span>
                    <a onclick="trocarCadastro()">Criar Conta</a>
                </div>

                <div class="links" id="termos">
                    <a href="#">Política de Privacidade</a>
                    <span> | </span>
                    <a href="#">Termos de Serviço</a>
                </div>

            </div>
        </div>
    </main>




</body>

</html>

<script>
    var codigo;
    var email_cad = input_email_cad.value;
    var cpf_cad = input_cpf.value;
    var senha_cad = input_senha_cad.value;
    var nome_cad = input_nome.value;
    var nascimento_cad = input_nascimento.value;
    var telefone_cad = input_telefone.value;
    var email_red = input_Remail.value;
    

    var NovaSenha = input_NovaSenha.value;

    function cadastrar(){
        nome_cad = input_nome.value;
        cpf_cad = input_cpf.value;
        email_cad = input_email_cad.value;
        senha_cad = input_senha_cad.value;
        nascimento_cad = input_nascimento.value;
        telefone_cad = input_telefone.value;

        if (
      email_cad == "" ||
      senha_cad == "" ||
      nome_cad == "" ||
      cpf_cad == "" ||
      nascimento_cad == "" ||
      telefone_cad == ""
      

    ) {
      alert("Preencha todos os campos!")
      return 

    } else if(
         nome_cad.length  <= 1) {
            alert("O nome precisa de dois ou mais caracteres")

     } else if(
        email_cad.indexOf("@") == -1 && email_cad.indexOf(".")) {
            alert("O email esta inválido")
     } else if (
        cpf_cad.length != 11 ){
            alert("O cpf esta inválido")
     } 

     return false
          



        trocarLogin();
    }

    function trocarLogin(){
        telaCadastro.style.display = 'none'
        telaLogin.style.display = 'flex'
        telaSenha.style.display = 'none'
    }

    function trocarCadastro(){
        telaCadastro.style.display = 'flex'
        telaLogin.style.display = 'none'
        telaSenha.style.display = 'none'
    }

    function trocarSenha(){
        telaSenha.style.display = 'flex'
        telaLogin.style.display = 'none'
        telaCadastro.style.display = 'none'
    }

    function gerar(){
        email_red = input_Remail.value;

        if (email_red == ""){
            alert("Preencha o email que terá a senha redefinida! \nPor meio dele enviaremos o código para redefinição!")
        } else {
        
        var codigo_recuperar_senha = ''

        for (var cont = 1; cont <= 6; cont++) {
            aleatorio = Math.random() * (10) + 0.5;
            aleatorio = aleatorio.toFixed(0)
            aleatorio = aleatorio - 1;
            aleatorio = aleatorio.toString()
            if (cont != 4) codigo_recuperar_senha += aleatorio;
            else codigo_recuperar_senha += '-' + aleatorio;
        }
        alert(`O seu código de acesso para redefinir a senha é: ${codigo_recuperar_senha}`); 
        }
        
    }

    function salvar (){
        senha_cad = input_NovaSenha.value;

        alert('Senha alterada com sucesso!')

        trocarLogin();
    }

    function redefinir(){
        var Rcdg = input_Rcdg.value;

        if(Rcdg == aleatorio){
            input_Rcdg.style.display = 'none';
            input_Remail.style.display = 'none';
            bt_gerar.style.display = 'none';
            bt_redefinir_senha.style.display = 'none';


            bt_salvar_senha.style.display = 'block';
            input_NovaSenha.style.display = 'block';
        }
    }


    function autenticar(){
        var email_log = input_login.value;
        var senha_log = input_senha.value;

        if (email_log == email_cad && senha_log == senha_cad){
            window.location.href = "../../Site/dashboard/dashboard.html";
        } else {
            alert ('Senha ou email incorreto')
        }
    }
</script>